{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\n\nvar fs = require('fs');\nvar os = require('os');\nvar path = require('path');\nvar rimraf = require('rimraf');\n\n// added node .10\n// http://stackoverflow.com/questions/21698906/how-to-check-if-a-path-is-absolute-or-relative/30714706#30714706\nfunction isAbsolute(dir) {\n  return path.normalize(dir + path.sep) === path.normalize(path.resolve(dir) + path.sep);\n}\n\nfunction upperCaseWindowsRoot(dir) {\n  var splitPath = dir.split(path.sep);\n  splitPath[0] = splitPath[0].toUpperCase();\n  return splitPath.join(path.sep);\n}\n\nfunction CleanWebpackPlugin(paths, options) {\n  //backwards compatibility\n  if (typeof options === 'string') {\n    options = {\n      root: options\n    }\n  }\n\n  options = options || {};\n  if (options.verbose === undefined) {\n    if (process.env.NODE_ENV === 'test') {\n      options.verbose = false;\n    } else {\n      options.verbose = true;\n    }\n  }\n  options.allowExternal = options.allowExternal || false;\n\n  if (options.dry === undefined) {\n    options.dry = false;\n  }\n\n  // determine webpack root\n  options.root = options.root || path.dirname(module.parent.filename);\n\n  // allows for a single string entry\n  if (typeof paths == 'string' || paths instanceof String) {\n    paths = [paths];\n  }\n\n  // store paths and options\n  this.paths = paths;\n  this.options = options;\n}\n\nvar clean = function() {\n  var _this = this;\n  var results = [];\n  var workingDir;\n  var dirName;\n  var projectRootDir;\n  var webpackDir;\n\n  // exit if no paths passed in\n  if (_this.paths === void 0) {\n    results.push({ path: _this.paths, output: 'nothing to clean' });\n    return results;\n  }\n\n  if (!isAbsolute(_this.options.root)) {\n    _this.options.verbose && console.warn(\n      'clean-webpack-plugin: ' + _this.options.root +\n      ' project root must be an absolute path. Skipping all...');\n    results.push({ path: _this.options.root, output: 'project root must be an absolute path' });\n    return results;\n  }\n\n  workingDir = process.cwd();\n  dirName = __dirname;\n  projectRootDir = path.resolve(_this.options.root);\n  webpackDir = path.dirname(module.parent.filename);\n\n  if (os.platform() === 'win32') {\n    workingDir = upperCaseWindowsRoot(workingDir);\n    dirName = upperCaseWindowsRoot(dirName);\n    projectRootDir = upperCaseWindowsRoot(projectRootDir);\n    webpackDir = upperCaseWindowsRoot(webpackDir);\n  }\n\n  // preform an rm -rf on each path\n  _this.paths.forEach(function(rimrafPath) {\n    rimrafPath = path.resolve(_this.options.root, rimrafPath);\n\n    if (os.platform() === 'win32') {\n      rimrafPath = upperCaseWindowsRoot(rimrafPath);\n    }\n\n    // disallow deletion any directories outside of root path.\n    if (rimrafPath.indexOf(projectRootDir) < 0 && !_this.options.allowExternal) {\n      _this.options.verbose && console.warn(\n        'clean-webpack-plugin: ' + rimrafPath + ' is outside of the project root. Skipping...');\n      results.push({ path: rimrafPath, output: 'must be inside the project root' });\n      return;\n    }\n\n    if (rimrafPath === projectRootDir) {\n      _this.options.verbose &&\n        console.warn(\n          'clean-webpack-plugin: ' + rimrafPath + ' is equal to project root. Skipping...');\n      results.push({ path: rimrafPath, output: 'is equal to project root' });\n      return;\n    }\n\n    if (rimrafPath === webpackDir) {\n      _this.options.verbose &&\n        console.warn('clean-webpack-plugin: ' + rimrafPath + ' would delete webpack. Skipping...');\n      results.push({ path: rimrafPath, output: 'would delete webpack' });\n      return;\n    }\n\n    if (rimrafPath === dirName || rimrafPath === workingDir) {\n      _this.options.verbose &&\n        console.log('clean-webpack-plugin: ' + rimrafPath + ' is working directory. Skipping...');\n      results.push({ path: rimrafPath, output: 'is working directory' });\n      return;\n    }\n\n    var childrenAfterExcluding = [];\n    var excludedChildren = [];\n\n    if (_this.options.exclude && _this.options.exclude.length) {\n      try {\n        var pathStat = fs.statSync(rimrafPath);\n        if (pathStat.isDirectory()) {\n          childrenAfterExcluding = fs.readdirSync(rimrafPath)\n            .filter(function(childFile) {\n              var include = _this.options.exclude.indexOf(childFile) < 0;\n              if (!include) {\n                excludedChildren.push(childFile);\n              }\n              return include;\n            })\n            .map(function(file) {\n              var fullPath = path.join(rimrafPath, file);\n              if (os.platform() === 'win32') {\n                fullPath = upperCaseWindowsRoot(fullPath);\n              }\n              return fullPath;\n            });\n        }\n        if (_this.options.exclude.indexOf('.') >= 0) {\n          excludedChildren.push('.');\n        }\n      } catch (e) {\n        childrenAfterExcluding = [];\n      }\n    }\n\n    if (_this.options.dry !== true) {\n      if (_this.options.exclude && excludedChildren.length) {\n        childrenAfterExcluding.forEach(function(child) {\n          rimraf.sync(child);\n        });\n      } else {\n        rimraf.sync(rimrafPath);\n      }\n    }\n\n    _this.options.verbose &&\n      console.warn('clean-webpack-plugin: ' + rimrafPath + ' has been removed.');\n    _this.options.verbose && excludedChildren.length &&\n      console.warn('clean-webpack-plugin: ' + excludedChildren.length + ' file(s) excluded - ' + excludedChildren.join(', '));\n\n    excludedChildren.length ?\n      results.push({ path: rimrafPath, output: 'removed with exclusions (' + excludedChildren.length + ')' }) :\n      results.push({ path: rimrafPath, output: 'removed' });\n  });\n\n  return results;\n};\n\nCleanWebpackPlugin.prototype.apply = function(compiler) {\n  var _this = this;\n  if (compiler === undefined) {\n    return clean.call(_this);\n  } else {\n    if (_this.options.watch) {\n      compiler.plugin(\"compile\", function(params) {\n        clean.call(_this);\n      });\n    } else {\n      return clean.call(_this);\n    }\n  }\n};\n\nmodule.exports = CleanWebpackPlugin;"]}