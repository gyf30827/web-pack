{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\nvar vm = require('vm');\nvar fs = require('fs');\nvar _ = require('lodash');\nvar Promise = require('bluebird');\nvar path = require('path');\nvar childCompiler = require('./lib/compiler.js');\nvar prettyError = require('./lib/errors.js');\nvar chunkSorter = require('./lib/chunksorter.js');\nPromise.promisifyAll(fs);\n\nfunction HtmlWebpackPlugin (options) {\n  // Default options\n  this.options = _.extend({\n    template: path.join(__dirname, 'default_index.ejs'),\n    filename: 'index.html',\n    hash: false,\n    inject: true,\n    compile: true,\n    favicon: false,\n    minify: false,\n    cache: true,\n    showErrors: true,\n    chunks: 'all',\n    excludeChunks: [],\n    title: 'Webpack App',\n    xhtml: false\n  }, options);\n}\n\nHtmlWebpackPlugin.prototype.apply = function (compiler) {\n  var self = this;\n  var isCompilationCached = false;\n  var compilationPromise;\n\n  this.options.template = this.getFullTemplatePath(this.options.template, compiler.context);\n\n  // convert absolute filename into relative so that webpack can\n  // generate it at correct location\n  var filename = this.options.filename;\n  if (path.resolve(filename) === path.normalize(filename)) {\n    this.options.filename = path.relative(compiler.options.output.path, filename);\n  }\n\n  compiler.plugin('make', function (compilation, callback) {\n    // Compile the template (queued)\n    compilationPromise = childCompiler.compileTemplate(self.options.template, compiler.context, self.options.filename, compilation)\n      .catch(function (err) {\n        compilation.errors.push(prettyError(err, compiler.context).toString());\n        return {\n          content: self.options.showErrors ? prettyError(err, compiler.context).toJsonHtml() : 'ERROR',\n          outputName: self.options.filename\n        };\n      })\n      .then(function (compilationResult) {\n        // If the compilation change didnt change the cache is valid\n        isCompilationCached = compilationResult.hash && self.childCompilerHash === compilationResult.hash;\n        self.childCompilerHash = compilationResult.hash;\n        self.childCompilationOutputName = compilationResult.outputName;\n        callback();\n        return compilationResult.content;\n      });\n  });\n\n  compiler.plugin('emit', function (compilation, callback) {\n    var applyPluginsAsyncWaterfall = self.applyPluginsAsyncWaterfall(compilation);\n    // Get all chunks\n    var allChunks = compilation.getStats().toJson().chunks;\n    // Filter chunks (options.chunks and options.excludeCHunks)\n    var chunks = self.filterChunks(allChunks, self.options.chunks, self.options.excludeChunks);\n    // Sort chunks\n    chunks = self.sortChunks(chunks, self.options.chunksSortMode);\n    // Let plugins alter the chunks and the chunk sorting\n    chunks = compilation.applyPluginsWaterfall('html-webpack-plugin-alter-chunks', chunks, { plugin: self });\n    // Get assets\n    var assets = self.htmlWebpackPluginAssets(compilation, chunks);\n    // If this is a hot update compilation, move on!\n    // This solves a problem where an `index.html` file is generated for hot-update js files\n    // It only happens in Webpack 2, where hot updates are emitted separately before the full bundle\n    if (self.isHotUpdateCompilation(assets)) {\n      return callback();\n    }\n\n    // If the template and the assets did not change we don't have to emit the html\n    var assetJson = JSON.stringify(self.getAssetFiles(assets));\n    if (isCompilationCached && self.options.cache && assetJson === self.assetJson) {\n      return callback();\n    } else {\n      self.assetJson = assetJson;\n    }\n\n    Promise.resolve()\n      // Favicon\n      .then(function () {\n        if (self.options.favicon) {\n          return self.addFileToAssets(self.options.favicon, compilation)\n            .then(function (faviconBasename) {\n              var publicPath = compilation.mainTemplate.getPublicPath({hash: compilation.hash}) || '';\n              if (publicPath && publicPath.substr(-1) !== '/') {\n                publicPath += '/';\n              }\n              assets.favicon = publicPath + faviconBasename;\n            });\n        }\n      })\n      // Wait for the compilation to finish\n      .then(function () {\n        return compilationPromise;\n      })\n      .then(function (compiledTemplate) {\n        // Allow to use a custom function / string instead\n        if (self.options.templateContent !== undefined) {\n          return self.options.templateContent;\n        }\n        // Once everything is compiled evaluate the html factory\n        // and replace it with its content\n        return self.evaluateCompilationResult(compilation, compiledTemplate);\n      })\n      // Allow plugins to make changes to the assets before invoking the template\n      // This only makes sense to use if `inject` is `false`\n      .then(function (compilationResult) {\n        return applyPluginsAsyncWaterfall('html-webpack-plugin-before-html-generation', false, {\n          assets: assets,\n          outputName: self.childCompilationOutputName,\n          plugin: self\n        })\n        .then(function () {\n          return compilationResult;\n        });\n      })\n      // Execute the template\n      .then(function (compilationResult) {\n        // If the loader result is a function execute it to retrieve the html\n        // otherwise use the returned html\n        return typeof compilationResult !== 'function'\n          ? compilationResult\n          : self.executeTemplate(compilationResult, chunks, assets, compilation);\n      })\n      // Allow plugins to change the html before assets are injected\n      .then(function (html) {\n        var pluginArgs = {html: html, assets: assets, plugin: self, outputName: self.childCompilationOutputName};\n        return applyPluginsAsyncWaterfall('html-webpack-plugin-before-html-processing', true, pluginArgs);\n      })\n      .then(function (result) {\n        var html = result.html;\n        var assets = result.assets;\n        // Prepare script and link tags\n        var assetTags = self.generateAssetTags(assets);\n        var pluginArgs = {head: assetTags.head, body: assetTags.body, plugin: self, chunks: chunks, outputName: self.childCompilationOutputName};\n        // Allow plugins to change the assetTag definitions\n        return applyPluginsAsyncWaterfall('html-webpack-plugin-alter-asset-tags', true, pluginArgs)\n          .then(function (result) {\n              // Add the stylesheets, scripts and so on to the resulting html\n            return self.postProcessHtml(html, assets, { body: result.body, head: result.head })\n              .then(function (html) {\n                return _.extend(result, {html: html, assets: assets});\n              });\n          });\n      })\n      // Allow plugins to change the html after assets are injected\n      .then(function (result) {\n        var html = result.html;\n        var assets = result.assets;\n        var pluginArgs = {html: html, assets: assets, plugin: self, outputName: self.childCompilationOutputName};\n        return applyPluginsAsyncWaterfall('html-webpack-plugin-after-html-processing', true, pluginArgs)\n          .then(function (result) {\n            return result.html;\n          });\n      })\n      .catch(function (err) {\n        // In case anything went wrong the promise is resolved\n        // with the error message and an error is logged\n        compilation.errors.push(prettyError(err, compiler.context).toString());\n        // Prevent caching\n        self.hash = null;\n        return self.options.showErrors ? prettyError(err, compiler.context).toHtml() : 'ERROR';\n      })\n      .then(function (html) {\n        // Replace the compilation result with the evaluated html code\n        compilation.assets[self.childCompilationOutputName] = {\n          source: function () {\n            return html;\n          },\n          size: function () {\n            return html.length;\n          }\n        };\n      })\n      .then(function () {\n        // Let other plugins know that we are done:\n        return applyPluginsAsyncWaterfall('html-webpack-plugin-after-emit', false, {\n          html: compilation.assets[self.childCompilationOutputName],\n          outputName: self.childCompilationOutputName,\n          plugin: self\n        }).catch(function (err) {\n          console.error(err);\n          return null;\n        }).then(function () {\n          return null;\n        });\n      })\n      // Let webpack continue with it\n      .finally(function () {\n        callback();\n        // Tell blue bird that we don't want to wait for callback.\n        // Fixes \"Warning: a promise was created in a handler but none were returned from it\"\n        // https://github.com/petkaantonov/bluebird/blob/master/docs/docs/warning-explanations.md#warning-a-promise-was-created-in-a-handler-but-none-were-returned-from-it\n        return null;\n      });\n  });\n};\n\n/**\n * Evaluates the child compilation result\n * Returns a promise\n */\nHtmlWebpackPlugin.prototype.evaluateCompilationResult = function (compilation, source) {\n  if (!source) {\n    return Promise.reject('The child compilation didn\\'t provide a result');\n  }\n\n  // The LibraryTemplatePlugin stores the template result in a local variable.\n  // To extract the result during the evaluation this part has to be removed.\n  source = source.replace('var HTML_WEBPACK_PLUGIN_RESULT =', '');\n  var template = this.options.template.replace(/^.+!/, '').replace(/\\?.+$/, '');\n  var vmContext = vm.createContext(_.extend({HTML_WEBPACK_PLUGIN: true, require: require}, global));\n  var vmScript = new vm.Script(source, {filename: template});\n  // Evaluate code and cast to string\n  var newSource;\n  try {\n    newSource = vmScript.runInContext(vmContext);\n  } catch (e) {\n    return Promise.reject(e);\n  }\n  if (typeof newSource === 'object' && newSource.__esModule && newSource.default) {\n    newSource = newSource.default;\n  }\n  return typeof newSource === 'string' || typeof newSource === 'function'\n    ? Promise.resolve(newSource)\n    : Promise.reject('The loader \"' + this.options.template + '\" didn\\'t return html.');\n};\n\n/**\n * Html post processing\n *\n * Returns a promise\n */\nHtmlWebpackPlugin.prototype.executeTemplate = function (templateFunction, chunks, assets, compilation) {\n  var self = this;\n  return Promise.resolve()\n    // Template processing\n    .then(function () {\n      var templateParams = {\n        compilation: compilation,\n        webpack: compilation.getStats().toJson(),\n        webpackConfig: compilation.options,\n        htmlWebpackPlugin: {\n          files: assets,\n          options: self.options\n        }\n      };\n      var html = '';\n      try {\n        html = templateFunction(templateParams);\n      } catch (e) {\n        compilation.errors.push(new Error('Template execution failed: ' + e));\n        return Promise.reject(e);\n      }\n      return html;\n    });\n};\n\n/**\n * Html post processing\n *\n * Returns a promise\n */\nHtmlWebpackPlugin.prototype.postProcessHtml = function (html, assets, assetTags) {\n  var self = this;\n  if (typeof html !== 'string') {\n    return Promise.reject('Expected html to be a string but got ' + JSON.stringify(html));\n  }\n  return Promise.resolve()\n    // Inject\n    .then(function () {\n      if (self.options.inject) {\n        return self.injectAssetsIntoHtml(html, assets, assetTags);\n      } else {\n        return html;\n      }\n    })\n    // Minify\n    .then(function (html) {\n      if (self.options.minify) {\n        var minify = require('html-minifier').minify;\n        return minify(html, self.options.minify);\n      }\n      return html;\n    });\n};\n\n/*\n * Pushes the content of the given filename to the compilation assets\n */\nHtmlWebpackPlugin.prototype.addFileToAssets = function (filename, compilation) {\n  filename = path.resolve(compilation.compiler.context, filename);\n  return Promise.props({\n    size: fs.statAsync(filename),\n    source: fs.readFileAsync(filename)\n  })\n  .catch(function () {\n    return Promise.reject(new Error('HtmlWebpackPlugin: could not load file ' + filename));\n  })\n  .then(function (results) {\n    var basename = path.basename(filename);\n    compilation.fileDependencies.push(filename);\n    compilation.assets[basename] = {\n      source: function () {\n        return results.source;\n      },\n      size: function () {\n        return results.size.size;\n      }\n    };\n    return basename;\n  });\n};\n\n/**\n * Helper to sort chunks\n */\nHtmlWebpackPlugin.prototype.sortChunks = function (chunks, sortMode) {\n  // Sort mode auto by default:\n  if (typeof sortMode === 'undefined') {\n    sortMode = 'auto';\n  }\n  // Custom function\n  if (typeof sortMode === 'function') {\n    return chunks.sort(sortMode);\n  }\n  // Disabled sorting:\n  if (sortMode === 'none') {\n    return chunkSorter.none(chunks);\n  }\n  // Check if the given sort mode is a valid chunkSorter sort mode\n  if (typeof chunkSorter[sortMode] !== 'undefined') {\n    return chunkSorter[sortMode](chunks, this.options.chunks);\n  }\n  throw new Error('\"' + sortMode + '\" is not a valid chunk sort mode');\n};\n\n/**\n * Return all chunks from the compilation result which match the exclude and include filters\n */\nHtmlWebpackPlugin.prototype.filterChunks = function (chunks, includedChunks, excludedChunks) {\n  return chunks.filter(function (chunk) {\n    var chunkName = chunk.names[0];\n    // This chunk doesn't have a name. This script can't handled it.\n    if (chunkName === undefined) {\n      return false;\n    }\n    // Skip if the chunk should be lazy loaded\n    if (typeof chunk.isInitial === 'function') {\n      if (!chunk.isInitial()) {\n        return false;\n      }\n    } else if (!chunk.initial) {\n      return false;\n    }\n    // Skip if the chunks should be filtered and the given chunk was not added explicity\n    if (Array.isArray(includedChunks) && includedChunks.indexOf(chunkName) === -1) {\n      return false;\n    }\n    // Skip if the chunks should be filtered and the given chunk was excluded explicity\n    if (Array.isArray(excludedChunks) && excludedChunks.indexOf(chunkName) !== -1) {\n      return false;\n    }\n    // Add otherwise\n    return true;\n  });\n};\n\nHtmlWebpackPlugin.prototype.isHotUpdateCompilation = function (assets) {\n  return assets.js.length && assets.js.every(function (name) {\n    return /\\.hot-update\\.js$/.test(name);\n  });\n};\n\nHtmlWebpackPlugin.prototype.htmlWebpackPluginAssets = function (compilation, chunks) {\n  var self = this;\n  var compilationHash = compilation.hash;\n\n  // Use the configured public path or build a relative path\n  var publicPath = typeof compilation.options.output.publicPath !== 'undefined'\n    // If a hard coded public path exists use it\n    ? compilation.mainTemplate.getPublicPath({hash: compilationHash})\n    // If no public path was set get a relative url path\n    : path.relative(path.resolve(compilation.options.output.path, path.dirname(self.childCompilationOutputName)), compilation.options.output.path)\n      .split(path.sep).join('/');\n\n  if (publicPath.length && publicPath.substr(-1, 1) !== '/') {\n    publicPath += '/';\n  }\n\n  var assets = {\n    // The public path\n    publicPath: publicPath,\n    // Will contain all js & css files by chunk\n    chunks: {},\n    // Will contain all js files\n    js: [],\n    // Will contain all css files\n    css: [],\n    // Will contain the html5 appcache manifest files if it exists\n    manifest: Object.keys(compilation.assets).filter(function (assetFile) {\n      return path.extname(assetFile) === '.appcache';\n    })[0]\n  };\n\n  // Append a hash for cache busting\n  if (this.options.hash) {\n    assets.manifest = self.appendHash(assets.manifest, compilationHash);\n    assets.favicon = self.appendHash(assets.favicon, compilationHash);\n  }\n\n  for (var i = 0; i < chunks.length; i++) {\n    var chunk = chunks[i];\n    var chunkName = chunk.names[0];\n\n    assets.chunks[chunkName] = {};\n\n    // Prepend the public path to all chunk files\n    var chunkFiles = [].concat(chunk.files).map(function (chunkFile) {\n      return publicPath + chunkFile;\n    });\n\n    // Append a hash for cache busting\n    if (this.options.hash) {\n      chunkFiles = chunkFiles.map(function (chunkFile) {\n        return self.appendHash(chunkFile, compilationHash);\n      });\n    }\n\n    // Webpack outputs an array for each chunk when using sourcemaps\n    // But we need only the entry file\n    var entry = chunkFiles[0];\n    assets.chunks[chunkName].size = chunk.size;\n    assets.chunks[chunkName].entry = entry;\n    assets.chunks[chunkName].hash = chunk.hash;\n    assets.js.push(entry);\n\n    // Gather all css files\n    var css = chunkFiles.filter(function (chunkFile) {\n      // Some chunks may contain content hash in their names, for ex. 'main.css?1e7cac4e4d8b52fd5ccd2541146ef03f'.\n      // We must proper handle such cases, so we use regexp testing here\n      return /.css($|\\?)/.test(chunkFile);\n    });\n    assets.chunks[chunkName].css = css;\n    assets.css = assets.css.concat(css);\n  }\n\n  // Duplicate css assets can occur on occasion if more than one chunk\n  // requires the same css.\n  assets.css = _.uniq(assets.css);\n\n  return assets;\n};\n\n/**\n * Injects the assets into the given html string\n */\nHtmlWebpackPlugin.prototype.generateAssetTags = function (assets) {\n  // Turn script files into script tags\n  var scripts = assets.js.map(function (scriptPath) {\n    return {\n      tagName: 'script',\n      closeTag: true,\n      attributes: {\n        type: 'text/javascript',\n        src: scriptPath\n      }\n    };\n  });\n  // Make tags self-closing in case of xhtml\n  var selfClosingTag = !!this.options.xhtml;\n  // Turn css files into link tags\n  var styles = assets.css.map(function (stylePath) {\n    return {\n      tagName: 'link',\n      selfClosingTag: selfClosingTag,\n      attributes: {\n        href: stylePath,\n        rel: 'stylesheet'\n      }\n    };\n  });\n  // Injection targets\n  var head = [];\n  var body = [];\n\n  // If there is a favicon present, add it to the head\n  if (assets.favicon) {\n    head.push({\n      tagName: 'link',\n      selfClosingTag: selfClosingTag,\n      attributes: {\n        rel: 'shortcut icon',\n        href: assets.favicon\n      }\n    });\n  }\n  // Add styles to the head\n  head = head.concat(styles);\n  // Add scripts to body or head\n  if (this.options.inject === 'head') {\n    head = head.concat(scripts);\n  } else {\n    body = body.concat(scripts);\n  }\n  return {head: head, body: body};\n};\n\n/**\n * Injects the assets into the given html string\n */\nHtmlWebpackPlugin.prototype.injectAssetsIntoHtml = function (html, assets, assetTags) {\n  var htmlRegExp = /(<html[^>]*>)/i;\n  var headRegExp = /(<\\/head\\s*>)/i;\n  var bodyRegExp = /(<\\/body\\s*>)/i;\n  var body = assetTags.body.map(this.createHtmlTag);\n  var head = assetTags.head.map(this.createHtmlTag);\n\n  if (body.length) {\n    if (bodyRegExp.test(html)) {\n      // Append assets to body element\n      html = html.replace(bodyRegExp, function (match) {\n        return body.join('') + match;\n      });\n    } else {\n      // Append scripts to the end of the file if no <body> element exists:\n      html += body.join('');\n    }\n  }\n\n  if (head.length) {\n    // Create a head tag if none exists\n    if (!headRegExp.test(html)) {\n      if (!htmlRegExp.test(html)) {\n        html = '<head></head>' + html;\n      } else {\n        html = html.replace(htmlRegExp, function (match) {\n          return match + '<head></head>';\n        });\n      }\n    }\n\n    // Append assets to head element\n    html = html.replace(headRegExp, function (match) {\n      return head.join('') + match;\n    });\n  }\n\n  // Inject manifest into the opening html tag\n  if (assets.manifest) {\n    html = html.replace(/(<html[^>]*)(>)/i, function (match, start, end) {\n      // Append the manifest only if no manifest was specified\n      if (/\\smanifest\\s*=/.test(match)) {\n        return match;\n      }\n      return start + ' manifest=\"' + assets.manifest + '\"' + end;\n    });\n  }\n  return html;\n};\n\n/**\n * Appends a cache busting hash\n */\nHtmlWebpackPlugin.prototype.appendHash = function (url, hash) {\n  if (!url) {\n    return url;\n  }\n  return url + (url.indexOf('?') === -1 ? '?' : '&') + hash;\n};\n\n/**\n * Turn a tag definition into a html string\n */\nHtmlWebpackPlugin.prototype.createHtmlTag = function (tagDefinition) {\n  var attributes = Object.keys(tagDefinition.attributes || {})\n    .filter(function (attributeName) {\n      return tagDefinition.attributes[attributeName] !== false;\n    })\n    .map(function (attributeName) {\n      if (tagDefinition.attributes[attributeName] === true) {\n        return attributeName;\n      }\n      return attributeName + '=\"' + tagDefinition.attributes[attributeName] + '\"';\n    });\n  // Backport of 3.x void tag definition\n  var voidTag = tagDefinition.voidTag !== undefined ? tagDefinition.voidTag : !tagDefinition.closeTag;\n  var selfClosingTag = tagDefinition.voidTag !== undefined ? tagDefinition.voidTag && this.options.xhtml : tagDefinition.selfClosingTag;\n  return '<' + [tagDefinition.tagName].concat(attributes).join(' ') + (selfClosingTag ? '/' : '') + '>' +\n    (tagDefinition.innerHTML || '') +\n    (voidTag ? '' : '</' + tagDefinition.tagName + '>');\n};\n\n/**\n * Helper to return the absolute template path with a fallback loader\n */\nHtmlWebpackPlugin.prototype.getFullTemplatePath = function (template, context) {\n  // If the template doesn't use a loader use the lodash template loader\n  if (template.indexOf('!') === -1) {\n    template = require.resolve('./lib/loader.js') + '!' + path.resolve(context, template);\n  }\n  // Resolve template path\n  return template.replace(\n    /([!])([^/\\\\][^!?]+|[^/\\\\!?])($|\\?[^!?\\n]+$)/,\n    function (match, prefix, filepath, postfix) {\n      return prefix + path.resolve(filepath) + postfix;\n    });\n};\n\n/**\n * Helper to return a sorted unique array of all asset files out of the\n * asset object\n */\nHtmlWebpackPlugin.prototype.getAssetFiles = function (assets) {\n  var files = _.uniq(Object.keys(assets).filter(function (assetType) {\n    return assetType !== 'chunks' && assets[assetType];\n  }).reduce(function (files, assetType) {\n    return files.concat(assets[assetType]);\n  }, []));\n  files.sort();\n  return files;\n};\n\n/**\n * Helper to promisify compilation.applyPluginsAsyncWaterfall that returns\n * a function that helps to merge given plugin arguments with processed ones\n */\nHtmlWebpackPlugin.prototype.applyPluginsAsyncWaterfall = function (compilation) {\n  var promisedApplyPluginsAsyncWaterfall = Promise.promisify(compilation.applyPluginsAsyncWaterfall, {context: compilation});\n  return function (eventName, requiresResult, pluginArgs) {\n    return promisedApplyPluginsAsyncWaterfall(eventName, pluginArgs)\n      .then(function (result) {\n        if (requiresResult && !result) {\n          compilation.warnings.push(new Error('Using ' + eventName + ' without returning a result is deprecated.'));\n        }\n        return _.extend(pluginArgs, result);\n      });\n  };\n};\n\nmodule.exports = HtmlWebpackPlugin;\n"]}