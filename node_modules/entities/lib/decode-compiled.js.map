{"version":3,"sources":["decode.js"],"names":[],"mappings":"AAAA,IAAI,YAAY,QAAQ,uBAAR,CAAhB;AAAA,IACI,YAAY,QAAQ,qBAAR,CADhB;AAAA,IAEI,SAAY,QAAQ,kBAAR,CAFhB;AAAA,IAGI,kBAAkB,QAAQ,uBAAR,CAHtB;;AAKA,IAAI,kBAAmB,iBAAiB,MAAjB,CAAvB;AAAA,IACI,mBAAmB,iBAAiB,SAAjB,CADvB;;AAGA,SAAS,gBAAT,CAA0B,GAA1B,EAA8B;AAC7B,KAAI,OAAO,OAAO,IAAP,CAAY,GAAZ,EAAiB,IAAjB,CAAsB,GAAtB,CAAX;AAAA,KACI,UAAU,YAAY,GAAZ,CADd;;AAGA,SAAQ,0BAAR;;AAEA,KAAI,KAAK,IAAI,MAAJ,CAAW,SAAS,IAAT,GAAgB,IAA3B,EAAiC,GAAjC,CAAT;;AAEA,QAAO,UAAS,GAAT,EAAa;AACnB,SAAO,OAAO,GAAP,EAAY,OAAZ,CAAoB,EAApB,EAAwB,OAAxB,CAAP;AACA,EAFD;AAGA;;AAED,IAAI,aAAc,YAAU;AAC3B,KAAI,SAAS,OAAO,IAAP,CAAY,SAAZ,EACX,IADW,CACN,MADM,CAAb;;AAGA,KAAI,OAAO,OAAO,IAAP,CAAY,SAAZ,EACT,IADS,CACJ,MADI,CAAX;;AAGA,MAAI,IAAI,IAAI,CAAR,EAAW,IAAI,CAAnB,EAAsB,IAAI,KAAK,MAA/B,EAAuC,GAAvC,EAA2C;AAC1C,MAAG,OAAO,CAAP,MAAc,KAAK,CAAL,CAAjB,EAAyB;AACxB,QAAK,CAAL,KAAW,IAAX;AACA;AACA,GAHD,MAGO;AACN,QAAK,CAAL,KAAW,GAAX;AACA;AACD;;AAED,KAAI,KAAK,IAAI,MAAJ,CAAW,SAAS,KAAK,IAAL,CAAU,GAAV,CAAT,GAA0B,+BAArC,EAAsE,GAAtE,CAAT;AAAA,KACI,UAAU,YAAY,SAAZ,CADd;;AAGA,UAAS,QAAT,CAAkB,GAAlB,EAAsB;AACrB,MAAG,IAAI,MAAJ,CAAW,CAAC,CAAZ,MAAmB,GAAtB,EAA2B,OAAO,GAAP;AAC3B,SAAO,QAAQ,GAAR,CAAP;AACA;;AAED;AACA,QAAO,UAAS,GAAT,EAAa;AACnB,SAAO,OAAO,GAAP,EAAY,OAAZ,CAAoB,EAApB,EAAwB,QAAxB,CAAP;AACA,EAFD;AAGA,CA5BiB,EAAlB;;AA8BA,SAAS,MAAT,CAAgB,CAAhB,EAAmB,CAAnB,EAAqB;AACpB,QAAO,IAAI,CAAJ,GAAQ,CAAR,GAAY,CAAC,CAApB;AACA;;AAED,SAAS,WAAT,CAAqB,GAArB,EAAyB;AACxB,QAAO,SAAS,OAAT,CAAiB,GAAjB,EAAqB;AAC3B,MAAG,IAAI,MAAJ,CAAW,CAAX,MAAkB,GAArB,EAAyB;AACxB,OAAG,IAAI,MAAJ,CAAW,CAAX,MAAkB,GAAlB,IAAyB,IAAI,MAAJ,CAAW,CAAX,MAAkB,GAA9C,EAAkD;AACjD,WAAO,gBAAgB,SAAS,IAAI,MAAJ,CAAW,CAAX,CAAT,EAAwB,EAAxB,CAAhB,CAAP;AACA;AACD,UAAO,gBAAgB,SAAS,IAAI,MAAJ,CAAW,CAAX,CAAT,EAAwB,EAAxB,CAAhB,CAAP;AACA;AACD,SAAO,IAAI,IAAI,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAAJ,CAAP;AACA,EARD;AASA;;AAED,OAAO,OAAP,GAAiB;AAChB,MAAK,eADW;AAEhB,OAAM,UAFU;AAGhB,aAAY;AAHI,CAAjB","file":"decode-compiled.js","sourcesContent":["var entityMap = require(\"../maps/entities.json\"),\n    legacyMap = require(\"../maps/legacy.json\"),\n    xmlMap    = require(\"../maps/xml.json\"),\n    decodeCodePoint = require(\"./decode_codepoint.js\");\n\nvar decodeXMLStrict  = getStrictDecoder(xmlMap),\n    decodeHTMLStrict = getStrictDecoder(entityMap);\n\nfunction getStrictDecoder(map){\n\tvar keys = Object.keys(map).join(\"|\"),\n\t    replace = getReplacer(map);\n\n\tkeys += \"|#[xX][\\\\da-fA-F]+|#\\\\d+\";\n\n\tvar re = new RegExp(\"&(?:\" + keys + \");\", \"g\");\n\n\treturn function(str){\n\t\treturn String(str).replace(re, replace);\n\t};\n}\n\nvar decodeHTML = (function(){\n\tvar legacy = Object.keys(legacyMap)\n\t\t.sort(sorter);\n\n\tvar keys = Object.keys(entityMap)\n\t\t.sort(sorter);\n\n\tfor(var i = 0, j = 0; i < keys.length; i++){\n\t\tif(legacy[j] === keys[i]){\n\t\t\tkeys[i] += \";?\";\n\t\t\tj++;\n\t\t} else {\n\t\t\tkeys[i] += \";\";\n\t\t}\n\t}\n\n\tvar re = new RegExp(\"&(?:\" + keys.join(\"|\") + \"|#[xX][\\\\da-fA-F]+;?|#\\\\d+;?)\", \"g\"),\n\t    replace = getReplacer(entityMap);\n\n\tfunction replacer(str){\n\t\tif(str.substr(-1) !== \";\") str += \";\";\n\t\treturn replace(str);\n\t}\n\n\t//TODO consider creating a merged map\n\treturn function(str){\n\t\treturn String(str).replace(re, replacer);\n\t};\n}());\n\nfunction sorter(a, b){\n\treturn a < b ? 1 : -1;\n}\n\nfunction getReplacer(map){\n\treturn function replace(str){\n\t\tif(str.charAt(1) === \"#\"){\n\t\t\tif(str.charAt(2) === \"X\" || str.charAt(2) === \"x\"){\n\t\t\t\treturn decodeCodePoint(parseInt(str.substr(3), 16));\n\t\t\t}\n\t\t\treturn decodeCodePoint(parseInt(str.substr(2), 10));\n\t\t}\n\t\treturn map[str.slice(1, -1)];\n\t};\n}\n\nmodule.exports = {\n\tXML: decodeXMLStrict,\n\tHTML: decodeHTML,\n\tHTMLStrict: decodeHTMLStrict\n};"]}