{"version":3,"sources":["ParsedError.js"],"names":[],"mappings":"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","file":"ParsedError-compiled.js","sourcesContent":["// Generated by CoffeeScript 1.8.0\nvar ParsedError, prop, sysPath, _fn, _i, _len, _ref;\n\nsysPath = require('path');\n\nmodule.exports = ParsedError = (function() {\n  function ParsedError(error) {\n    this.error = error;\n    this._parse();\n  }\n\n  ParsedError.prototype._parse = function() {\n    var m;\n    this._trace = [];\n    this._kind = 'Error';\n    this._wrapper = '';\n    if (this.error.wrapper != null) {\n      this._wrapper = String(this.error.wrapper);\n    }\n    if (typeof this.error !== 'object') {\n      this._message = String(this.error);\n    } else {\n      this._stack = this.error.stack;\n      if (this.error.kind != null) {\n        this._kind = String(this.error.kind);\n      } else if (typeof this._stack === 'string') {\n        if (m = this._stack.match(/^([a-zA-Z0-9\\_\\$]+):\\ /)) {\n          this._kind = m[1];\n        }\n      }\n      if (typeof this._stack === 'string') {\n        this._parseStack();\n      } else {\n        this._message = (this.error.message != null) && String(this.error.message) || '';\n      }\n    }\n  };\n\n  ParsedError.prototype._parseStack = function() {\n    var line, message, messageLines, reachedTrace, _i, _len, _ref;\n    messageLines = [];\n    reachedTrace = false;\n    _ref = this._stack.split('\\n');\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      line = _ref[_i];\n      if (line.trim() === '') {\n        continue;\n      }\n      if (reachedTrace) {\n        this._trace.push(this._parseTraceItem(line));\n      } else {\n        if (line.match(/^\\s*at\\s.+/)) {\n          reachedTrace = true;\n          this._trace.push(this._parseTraceItem(line));\n        } else {\n          messageLines.push(line);\n        }\n      }\n    }\n    message = messageLines.join('\\n');\n    if (message.substr(0, this._kind.length) === this._kind) {\n      message = message.substr(this._kind.length, message.length).replace(/^\\:\\s+/, '');\n    }\n    this._message = message;\n  };\n\n  ParsedError.prototype._parseTraceItem = function(text) {\n    var addr, col, d, dir, file, jsCol, jsLine, line, m, original, packageName, packages, path, r, remaining, shortenedAddr, shortenedPath, what;\n    text = text.trim();\n    if (text === '') {\n      return;\n    }\n    if (!text.match(/^at\\ /)) {\n      return text;\n    }\n    text = text.replace(/^at /, '');\n    if (text === 'Error (<anonymous>)' || text === 'Error (<anonymous>:null:null)') {\n      return;\n    }\n    original = text;\n    what = null;\n    addr = null;\n    path = null;\n    dir = null;\n    file = null;\n    line = null;\n    col = null;\n    jsLine = null;\n    jsCol = null;\n    shortenedPath = null;\n    shortenedAddr = null;\n    packageName = '[current]';\n    if (m = text.match(/\\(([^\\)]+)\\)$/)) {\n      addr = m[1].trim();\n    }\n    if (addr != null) {\n      what = text.substr(0, text.length - addr.length - 2);\n      what = what.trim();\n    }\n    if (addr == null) {\n      addr = text.trim();\n    }\n    addr = this._fixPath(addr);\n    remaining = addr;\n    if (m = remaining.match(/\\,\\ <js>:(\\d+):(\\d+)$/)) {\n      jsLine = m[1];\n      jsCol = m[2];\n      remaining = remaining.substr(0, remaining.length - m[0].length);\n    }\n    if (m = remaining.match(/:(\\d+):(\\d+)$/)) {\n      line = m[1];\n      col = m[2];\n      remaining = remaining.substr(0, remaining.length - m[0].length);\n      path = remaining;\n    }\n    if (path != null) {\n      file = sysPath.basename(path);\n      dir = sysPath.dirname(path);\n      if (dir === '.') {\n        dir = '';\n      }\n      path = this._fixPath(path);\n      file = this._fixPath(file);\n      dir = this._fixPath(dir);\n    }\n    if (dir != null) {\n      d = dir.replace(/[\\\\]{1,2}/g, '/');\n      if (m = d.match(/node_modules\\/([^\\/]+)(?!.*node_modules.*)/)) {\n        packageName = m[1];\n      }\n    }\n    if (jsLine == null) {\n      jsLine = line;\n      jsCol = col;\n    }\n    if (path != null) {\n      r = this._rectifyPath(path);\n      shortenedPath = r.path;\n      shortenedAddr = shortenedPath + addr.substr(path.length, addr.length);\n      packages = r.packages;\n    }\n    return {\n      original: original,\n      what: what,\n      addr: addr,\n      path: path,\n      dir: dir,\n      file: file,\n      line: parseInt(line),\n      col: parseInt(col),\n      jsLine: parseInt(jsLine),\n      jsCol: parseInt(jsCol),\n      packageName: packageName,\n      shortenedPath: shortenedPath,\n      shortenedAddr: shortenedAddr,\n      packages: packages || []\n    };\n  };\n\n  ParsedError.prototype._getMessage = function() {\n    return this._message;\n  };\n\n  ParsedError.prototype._getKind = function() {\n    return this._kind;\n  };\n\n  ParsedError.prototype._getWrapper = function() {\n    return this._wrapper;\n  };\n\n  ParsedError.prototype._getStack = function() {\n    return this._stack;\n  };\n\n  ParsedError.prototype._getArguments = function() {\n    return this.error[\"arguments\"];\n  };\n\n  ParsedError.prototype._getType = function() {\n    return this.error.type;\n  };\n\n  ParsedError.prototype._getTrace = function() {\n    return this._trace;\n  };\n\n  ParsedError.prototype._fixPath = function(path) {\n    return path.replace(/[\\\\]{1,2}/g, '/');\n  };\n\n  ParsedError.prototype._rectifyPath = function(path, nameForCurrentPackage) {\n    var m, packages, parts, remaining, rest;\n    path = String(path);\n    remaining = path;\n    if (!(m = path.match(/^(.+?)\\/node_modules\\/(.+)$/))) {\n      return {\n        path: path,\n        packages: []\n      };\n    }\n    parts = [];\n    packages = [];\n    if (typeof nameForCurrentPackage === 'string') {\n      parts.push(\"[\" + nameForCurrentPackage + \"]\");\n      packages.push(\"[\" + nameForCurrentPackage + \"]\");\n    } else {\n      parts.push(\"[\" + (m[1].match(/([^\\/]+)$/)[1]) + \"]\");\n      packages.push(m[1].match(/([^\\/]+)$/)[1]);\n    }\n    rest = m[2];\n    while (m = rest.match(/([^\\/]+)\\/node_modules\\/(.+)$/)) {\n      parts.push(\"[\" + m[1] + \"]\");\n      packages.push(m[1]);\n      rest = m[2];\n    }\n    if (m = rest.match(/([^\\/]+)\\/(.+)$/)) {\n      parts.push(\"[\" + m[1] + \"]\");\n      packages.push(m[1]);\n      rest = m[2];\n    }\n    parts.push(rest);\n    return {\n      path: parts.join(\"/\"),\n      packages: packages\n    };\n  };\n\n  return ParsedError;\n\n})();\n\n_ref = ['message', 'kind', 'arguments', 'type', 'stack', 'trace', 'wrapper'];\n_fn = function() {\n  var methodName;\n  methodName = '_get' + prop[0].toUpperCase() + prop.substr(1, prop.length);\n  return Object.defineProperty(ParsedError.prototype, prop, {\n    get: function() {\n      return this[methodName]();\n    }\n  });\n};\nfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\n  prop = _ref[_i];\n  _fn();\n}\n"]}