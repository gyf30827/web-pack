{"version":3,"sources":["Tokenizer.js"],"names":[],"mappings":"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","file":"Tokenizer-compiled.js","sourcesContent":["module.exports = Tokenizer;\n\nvar entityMap = require(\"./entities/entities.json\"),\n    legacyMap = require(\"./entities/legacy.json\"),\n    xmlMap    = require(\"./entities/xml.json\"),\n    decodeMap = require(\"./entities/decode.json\"),\n\n    i = 0,\n\n    TEXT                      = i++,\n    BEFORE_TAG_NAME           = i++, //after <\n    IN_TAG_NAME               = i++,\n    IN_SELF_CLOSING_TAG       = i++,\n    BEFORE_CLOSING_TAG_NAME   = i++,\n    IN_CLOSING_TAG_NAME       = i++,\n    AFTER_CLOSING_TAG_NAME    = i++,\n\n    //attributes\n    BEFORE_ATTRIBUTE_NAME     = i++,\n    IN_ATTRIBUTE_NAME         = i++,\n    AFTER_ATTRIBUTE_NAME      = i++,\n    BEFORE_ATTRIBUTE_VALUE    = i++,\n    IN_ATTRIBUTE_VALUE_DQ     = i++, // \"\n    IN_ATTRIBUTE_VALUE_SQ     = i++, // '\n    IN_ATTRIBUTE_VALUE_NQ     = i++,\n\n    //declarations\n    BEFORE_DECLARATION        = i++, // !\n    IN_DECLARATION            = i++,\n\n    //processing instructions\n    IN_PROCESSING_INSTRUCTION = i++, // ?\n\n    //comments\n    BEFORE_COMMENT            = i++,\n    IN_COMMENT                = i++,\n    AFTER_COMMENT_1           = i++,\n    AFTER_COMMENT_2           = i++,\n\n    //cdata\n    BEFORE_CDATA_1            = i++, // [\n    BEFORE_CDATA_2            = i++, // C\n    BEFORE_CDATA_3            = i++, // D\n    BEFORE_CDATA_4            = i++, // A\n    BEFORE_CDATA_5            = i++, // T\n    BEFORE_CDATA_6            = i++, // A\n    IN_CDATA                  = i++,// [\n    AFTER_CDATA_1             = i++, // ]\n    AFTER_CDATA_2             = i++, // ]\n\n    //special tags\n    BEFORE_SPECIAL            = i++, //S\n    BEFORE_SPECIAL_END        = i++,   //S\n\n    BEFORE_SCRIPT_1           = i++, //C\n    BEFORE_SCRIPT_2           = i++, //R\n    BEFORE_SCRIPT_3           = i++, //I\n    BEFORE_SCRIPT_4           = i++, //P\n    BEFORE_SCRIPT_5           = i++, //T\n    AFTER_SCRIPT_1            = i++, //C\n    AFTER_SCRIPT_2            = i++, //R\n    AFTER_SCRIPT_3            = i++, //I\n    AFTER_SCRIPT_4            = i++, //P\n    AFTER_SCRIPT_5            = i++, //T\n\n    BEFORE_STYLE_1            = i++, //T\n    BEFORE_STYLE_2            = i++, //Y\n    BEFORE_STYLE_3            = i++, //L\n    BEFORE_STYLE_4            = i++, //E\n    AFTER_STYLE_1             = i++, //T\n    AFTER_STYLE_2             = i++, //Y\n    AFTER_STYLE_3             = i++, //L\n    AFTER_STYLE_4             = i++, //E\n\n    BEFORE_ENTITY             = i++, //&\n    BEFORE_NUMERIC_ENTITY     = i++, //#\n    IN_NAMED_ENTITY           = i++,\n    IN_NUMERIC_ENTITY         = i++,\n    IN_HEX_ENTITY             = i++, //X\n\n    j = 0,\n\n    SPECIAL_NONE              = j++,\n    SPECIAL_SCRIPT            = j++,\n    SPECIAL_STYLE             = j++;\n\nfunction whitespace(c){\n\treturn c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\n\nfunction ifElseState(upper, SUCCESS, FAILURE){\n\tvar lower = upper.toLowerCase();\n\n\tif(upper === lower){\n\t\treturn function(c){\n\t\t\tthis._state = c === lower ? SUCCESS : FAILURE;\n\t\t};\n\t} else {\n\t\treturn function(c){\n\t\t\tthis._state = (c === lower || c === upper) ? SUCCESS : FAILURE;\n\t\t};\n\t}\n}\n\nfunction consumeSpecialNameChar(upper, NEXT_STATE){\n\tvar lower = upper.toLowerCase();\n\n\treturn function(c){\n\t\tif(c === lower || c === upper){\n\t\t\tthis._state = NEXT_STATE;\n\t\t} else {\n\t\t\tthis._state = IN_TAG_NAME;\n\t\t\tthis._index--; //consume the token again\n\t\t}\n\t};\n}\n\nfunction Tokenizer(options, cbs){\n\tthis._state = TEXT;\n\tthis._buffer = \"\";\n\tthis._sectionStart = 0;\n\tthis._index = 0;\n\tthis._baseState = TEXT;\n\tthis._special = SPECIAL_NONE;\n\tthis._cbs = cbs;\n\tthis._running = true;\n\tthis._xmlMode = !!(options && options.xmlMode);\n\tthis._decodeEntities = !!(options && options.decodeEntities);\n}\n\nTokenizer.prototype._stateText = function(c){\n\tif(c === \"<\"){\n\t\tif(this._index > this._sectionStart){\n\t\t\tthis._cbs.ontext(this._getSection());\n\t\t}\n\t\tthis._state = BEFORE_TAG_NAME;\n\t\tthis._sectionStart = this._index;\n\t} else if(this._decodeEntities && this._special === SPECIAL_NONE && c === \"&\"){\n\t\tif(this._index > this._sectionStart){\n\t\t\tthis._cbs.ontext(this._getSection());\n\t\t}\n\t\tthis._baseState = TEXT;\n\t\tthis._state = BEFORE_ENTITY;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateBeforeTagName = function(c){\n\tif(c === \"/\"){\n\t\tthis._state = BEFORE_CLOSING_TAG_NAME;\n\t} else if(c === \">\" || this._special !== SPECIAL_NONE || whitespace(c)) {\n\t\tthis._state = TEXT;\n\t} else if(c === \"!\"){\n\t\tthis._state = BEFORE_DECLARATION;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c === \"?\"){\n\t\tthis._state = IN_PROCESSING_INSTRUCTION;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c === \"<\"){\n\t\tthis._cbs.ontext(this._getSection());\n\t\tthis._sectionStart = this._index;\n\t} else {\n\t\tthis._state = (!this._xmlMode && (c === \"s\" || c === \"S\")) ?\n\t\t\t\t\t\tBEFORE_SPECIAL : IN_TAG_NAME;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInTagName = function(c){\n\tif(c === \"/\" || c === \">\" || whitespace(c)){\n\t\tthis._emitToken(\"onopentagname\");\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateBeforeCloseingTagName = function(c){\n\tif(whitespace(c));\n\telse if(c === \">\"){\n\t\tthis._state = TEXT;\n\t} else if(this._special !== SPECIAL_NONE){\n\t\tif(c === \"s\" || c === \"S\"){\n\t\t\tthis._state = BEFORE_SPECIAL_END;\n\t\t} else {\n\t\t\tthis._state = TEXT;\n\t\t\tthis._index--;\n\t\t}\n\t} else {\n\t\tthis._state = IN_CLOSING_TAG_NAME;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInCloseingTagName = function(c){\n\tif(c === \">\" || whitespace(c)){\n\t\tthis._emitToken(\"onclosetag\");\n\t\tthis._state = AFTER_CLOSING_TAG_NAME;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateAfterCloseingTagName = function(c){\n\t//skip everything until \">\"\n\tif(c === \">\"){\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t}\n};\n\nTokenizer.prototype._stateBeforeAttributeName = function(c){\n\tif(c === \">\"){\n\t\tthis._cbs.onopentagend();\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c === \"/\"){\n\t\tthis._state = IN_SELF_CLOSING_TAG;\n\t} else if(!whitespace(c)){\n\t\tthis._state = IN_ATTRIBUTE_NAME;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInSelfClosingTag = function(c){\n\tif(c === \">\"){\n\t\tthis._cbs.onselfclosingtag();\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(!whitespace(c)){\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateInAttributeName = function(c){\n\tif(c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)){\n\t\tif(this._index > this._sectionStart){\n\t\t\tthis._cbs.onattribname(this._getSection());\n\t\t}\n\t\tthis._sectionStart = -1;\n\t\tthis._state = AFTER_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateAfterAttributeName = function(c){\n\tif(c === \"=\"){\n\t\tthis._state = BEFORE_ATTRIBUTE_VALUE;\n\t} else if(c === \"/\" || c === \">\"){\n\t\tthis._cbs.onattribend();\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t} else if(!whitespace(c)){\n\t\tthis._cbs.onattribend();\n\t\tthis._state = IN_ATTRIBUTE_NAME;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateBeforeAttributeValue = function(c){\n\tif(c === \"\\\"\"){\n\t\tthis._state = IN_ATTRIBUTE_VALUE_DQ;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c === \"'\"){\n\t\tthis._state = IN_ATTRIBUTE_VALUE_SQ;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(!whitespace(c)){\n\t\tthis._state = IN_ATTRIBUTE_VALUE_NQ;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInAttributeValueDoubleQuotes = function(c){\n\tif(c === \"\\\"\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._cbs.onattribend();\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t} else if(this._decodeEntities && c === \"&\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._baseState = this._state;\n\t\tthis._state = BEFORE_ENTITY;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInAttributeValueSingleQuotes = function(c){\n\tif(c === \"'\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._cbs.onattribend();\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t} else if(this._decodeEntities && c === \"&\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._baseState = this._state;\n\t\tthis._state = BEFORE_ENTITY;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateInAttributeValueNoQuotes = function(c){\n\tif(whitespace(c) || c === \">\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._cbs.onattribend();\n\t\tthis._state = BEFORE_ATTRIBUTE_NAME;\n\t\tthis._index--;\n\t} else if(this._decodeEntities && c === \"&\"){\n\t\tthis._emitToken(\"onattribdata\");\n\t\tthis._baseState = this._state;\n\t\tthis._state = BEFORE_ENTITY;\n\t\tthis._sectionStart = this._index;\n\t}\n};\n\nTokenizer.prototype._stateBeforeDeclaration = function(c){\n\tthis._state = c === \"[\" ? BEFORE_CDATA_1 :\n\t\t\t\t\tc === \"-\" ? BEFORE_COMMENT :\n\t\t\t\t\t\tIN_DECLARATION;\n};\n\nTokenizer.prototype._stateInDeclaration = function(c){\n\tif(c === \">\"){\n\t\tthis._cbs.ondeclaration(this._getSection());\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t}\n};\n\nTokenizer.prototype._stateInProcessingInstruction = function(c){\n\tif(c === \">\"){\n\t\tthis._cbs.onprocessinginstruction(this._getSection());\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t}\n};\n\nTokenizer.prototype._stateBeforeComment = function(c){\n\tif(c === \"-\"){\n\t\tthis._state = IN_COMMENT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else {\n\t\tthis._state = IN_DECLARATION;\n\t}\n};\n\nTokenizer.prototype._stateInComment = function(c){\n\tif(c === \"-\") this._state = AFTER_COMMENT_1;\n};\n\nTokenizer.prototype._stateAfterComment1 = ifElseState(\"-\", AFTER_COMMENT_2, IN_COMMENT);\n\nTokenizer.prototype._stateAfterComment2 = function(c){\n\tif(c === \">\"){\n\t\t//remove 2 trailing chars\n\t\tthis._cbs.oncomment(this._buffer.substring(this._sectionStart, this._index - 2));\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if(c !== \"-\"){\n\t\tthis._state = IN_COMMENT;\n\t}\n\t// else: stay in AFTER_COMMENT_2 (`--->`)\n};\n\nTokenizer.prototype._stateBeforeCdata1 = ifElseState(\"C\", BEFORE_CDATA_2, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata2 = ifElseState(\"D\", BEFORE_CDATA_3, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata3 = ifElseState(\"A\", BEFORE_CDATA_4, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata4 = ifElseState(\"T\", BEFORE_CDATA_5, IN_DECLARATION);\nTokenizer.prototype._stateBeforeCdata5 = ifElseState(\"A\", BEFORE_CDATA_6, IN_DECLARATION);\n\nTokenizer.prototype._stateBeforeCdata6 = function(c){\n\tif(c === \"[\"){\n\t\tthis._state = IN_CDATA;\n\t\tthis._sectionStart = this._index + 1;\n\t} else {\n\t\tthis._state = IN_DECLARATION;\n\t}\n};\n\nTokenizer.prototype._stateInCdata = function(c){\n\tif(c === \"]\") this._state = AFTER_CDATA_1;\n};\n\nTokenizer.prototype._stateAfterCdata1 = ifElseState(\"]\", AFTER_CDATA_2, IN_CDATA);\n\nTokenizer.prototype._stateAfterCdata2 = function(c){\n\tif(c === \">\"){\n\t\t//remove 2 trailing chars\n\t\tthis._cbs.oncdata(this._buffer.substring(this._sectionStart, this._index - 2));\n\t\tthis._state = TEXT;\n\t\tthis._sectionStart = this._index + 1;\n\t} else if (c !== \"]\") {\n\t\tthis._state = IN_CDATA;\n\t}\n\t//else: stay in AFTER_CDATA_2 (`]]]>`)\n};\n\nTokenizer.prototype._stateBeforeSpecial = function(c){\n\tif(c === \"c\" || c === \"C\"){\n\t\tthis._state = BEFORE_SCRIPT_1;\n\t} else if(c === \"t\" || c === \"T\"){\n\t\tthis._state = BEFORE_STYLE_1;\n\t} else {\n\t\tthis._state = IN_TAG_NAME;\n\t\tthis._index--; //consume the token again\n\t}\n};\n\nTokenizer.prototype._stateBeforeSpecialEnd = function(c){\n\tif(this._special === SPECIAL_SCRIPT && (c === \"c\" || c === \"C\")){\n\t\tthis._state = AFTER_SCRIPT_1;\n\t} else if(this._special === SPECIAL_STYLE && (c === \"t\" || c === \"T\")){\n\t\tthis._state = AFTER_STYLE_1;\n\t}\n\telse this._state = TEXT;\n};\n\nTokenizer.prototype._stateBeforeScript1 = consumeSpecialNameChar(\"R\", BEFORE_SCRIPT_2);\nTokenizer.prototype._stateBeforeScript2 = consumeSpecialNameChar(\"I\", BEFORE_SCRIPT_3);\nTokenizer.prototype._stateBeforeScript3 = consumeSpecialNameChar(\"P\", BEFORE_SCRIPT_4);\nTokenizer.prototype._stateBeforeScript4 = consumeSpecialNameChar(\"T\", BEFORE_SCRIPT_5);\n\nTokenizer.prototype._stateBeforeScript5 = function(c){\n\tif(c === \"/\" || c === \">\" || whitespace(c)){\n\t\tthis._special = SPECIAL_SCRIPT;\n\t}\n\tthis._state = IN_TAG_NAME;\n\tthis._index--; //consume the token again\n};\n\nTokenizer.prototype._stateAfterScript1 = ifElseState(\"R\", AFTER_SCRIPT_2, TEXT);\nTokenizer.prototype._stateAfterScript2 = ifElseState(\"I\", AFTER_SCRIPT_3, TEXT);\nTokenizer.prototype._stateAfterScript3 = ifElseState(\"P\", AFTER_SCRIPT_4, TEXT);\nTokenizer.prototype._stateAfterScript4 = ifElseState(\"T\", AFTER_SCRIPT_5, TEXT);\n\nTokenizer.prototype._stateAfterScript5 = function(c){\n\tif(c === \">\" || whitespace(c)){\n\t\tthis._special = SPECIAL_NONE;\n\t\tthis._state = IN_CLOSING_TAG_NAME;\n\t\tthis._sectionStart = this._index - 6;\n\t\tthis._index--; //reconsume the token\n\t}\n\telse this._state = TEXT;\n};\n\nTokenizer.prototype._stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", BEFORE_STYLE_2);\nTokenizer.prototype._stateBeforeStyle2 = consumeSpecialNameChar(\"L\", BEFORE_STYLE_3);\nTokenizer.prototype._stateBeforeStyle3 = consumeSpecialNameChar(\"E\", BEFORE_STYLE_4);\n\nTokenizer.prototype._stateBeforeStyle4 = function(c){\n\tif(c === \"/\" || c === \">\" || whitespace(c)){\n\t\tthis._special = SPECIAL_STYLE;\n\t}\n\tthis._state = IN_TAG_NAME;\n\tthis._index--; //consume the token again\n};\n\nTokenizer.prototype._stateAfterStyle1 = ifElseState(\"Y\", AFTER_STYLE_2, TEXT);\nTokenizer.prototype._stateAfterStyle2 = ifElseState(\"L\", AFTER_STYLE_3, TEXT);\nTokenizer.prototype._stateAfterStyle3 = ifElseState(\"E\", AFTER_STYLE_4, TEXT);\n\nTokenizer.prototype._stateAfterStyle4 = function(c){\n\tif(c === \">\" || whitespace(c)){\n\t\tthis._special = SPECIAL_NONE;\n\t\tthis._state = IN_CLOSING_TAG_NAME;\n\t\tthis._sectionStart = this._index - 5;\n\t\tthis._index--; //reconsume the token\n\t}\n\telse this._state = TEXT;\n};\n\nTokenizer.prototype._stateBeforeEntity = ifElseState(\"#\", BEFORE_NUMERIC_ENTITY, IN_NAMED_ENTITY);\nTokenizer.prototype._stateBeforeNumericEntity = ifElseState(\"X\", IN_HEX_ENTITY, IN_NUMERIC_ENTITY);\n\n//for entities within attributes\nTokenizer.prototype._parseNamedEntityStrict = function(){\n\t//offset = 1\n\tif(this._sectionStart + 1 < this._index){\n\t\tvar entity = this._buffer.substring(this._sectionStart + 1, this._index),\n\t\t    map = this._xmlMode ? xmlMap : entityMap;\n\n\t\tif(map.hasOwnProperty(entity)){\n\t\t\tthis._emitPartial(map[entity]);\n\t\t\tthis._sectionStart = this._index + 1;\n\t\t}\n\t}\n};\n\n\n//parses legacy entities (without trailing semicolon)\nTokenizer.prototype._parseLegacyEntity = function(){\n\tvar start = this._sectionStart + 1,\n\t    limit = this._index - start;\n\n\tif(limit > 6) limit = 6; //the max length of legacy entities is 6\n\n\twhile(limit >= 2){ //the min length of legacy entities is 2\n\t\tvar entity = this._buffer.substr(start, limit);\n\n\t\tif(legacyMap.hasOwnProperty(entity)){\n\t\t\tthis._emitPartial(legacyMap[entity]);\n\t\t\tthis._sectionStart += limit + 2;\n\t\t\tbreak;\n\t\t} else {\n\t\t\tlimit--;\n\t\t}\n\t}\n};\n\nTokenizer.prototype._stateInNamedEntity = function(c){\n\tif(c === \";\"){\n\t\tthis._parseNamedEntityStrict();\n\t\tif(this._sectionStart + 1 < this._index && !this._xmlMode){\n\t\t\tthis._parseLegacyEntity();\n\t\t}\n\t\tthis._state = this._baseState;\n\t} else if((c < \"a\" || c > \"z\") && (c < \"A\" || c > \"Z\") && (c < \"0\" || c > \"9\")){\n\t\tif(this._xmlMode);\n\t\telse if(this._baseState !== TEXT){\n\t\t\tif(c !== \"=\"){\n\t\t\t\tthis._parseNamedEntityStrict();\n\t\t\t\tthis._sectionStart--; //include the current character in the section\n\t\t\t}\n\t\t} else {\n\t\t\tthis._parseLegacyEntity();\n\t\t\tthis._sectionStart--;\n\t\t}\n\t\tthis._state = this._baseState;\n\t\tthis._index--;\n\t}\n};\n\n// modified version of https://github.com/mathiasbynens/he/blob/master/src/he.js#L94-L119\nfunction decodeCodePoint(codePoint){\n\tvar output = \"\";\n\n\tif((codePoint >= 0xD800 && codePoint <= 0xDFFF) || codePoint > 0x10FFFF){\n\t\treturn \"\\uFFFD\";\n\t}\n\n\tif(codePoint in decodeMap){\n\t\tcodePoint = decodeMap[codePoint];\n\t}\n\n\tif(codePoint > 0xFFFF){\n\t\tcodePoint -= 0x10000;\n\t\toutput += String.fromCharCode(codePoint >>> 10 & 0x3FF | 0xD800);\n\t\tcodePoint = 0xDC00 | codePoint & 0x3FF;\n\t}\n\n\toutput += String.fromCharCode(codePoint);\n\treturn output;\n}\n\nTokenizer.prototype._decodeNumericEntity = function(offset, base){\n\tvar sectionStart = this._sectionStart + offset;\n\n\tif(sectionStart !== this._index){\n\t\t//parse entity\n\t\tvar entity = this._buffer.substring(sectionStart, this._index);\n\t\tvar parsed = parseInt(entity, base);\n\n\t\tif(parsed === parsed){ //not NaN (TODO: when can this happen?)\n\t\t\tthis._emitPartial(decodeCodePoint(parsed));\n\t\t\tthis._sectionStart = this._index;\n\t\t}\n\t}\n\n\tthis._state = this._baseState;\n};\n\nTokenizer.prototype._stateInNumericEntity = function(c){\n\tif(c === \";\"){\n\t\tthis._decodeNumericEntity(2, 10);\n\t\tthis._sectionStart++;\n\t} else if(c < \"0\" || c > \"9\"){\n\t\tif(!this._xmlMode){\n\t\t\tthis._decodeNumericEntity(2, 10);\n\t\t} else {\n\t\t\tthis._state = this._baseState;\n\t\t}\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._stateInHexEntity = function(c){\n\tif(c === \";\"){\n\t\tthis._decodeNumericEntity(3, 16);\n\t\tthis._sectionStart++;\n\t} else if((c < \"a\" || c > \"f\") && (c < \"A\" || c > \"F\") && (c < \"0\" || c > \"9\")){\n\t\tif(!this._xmlMode){\n\t\t\tthis._decodeNumericEntity(3, 16);\n\t\t} else {\n\t\t\tthis._state = this._baseState;\n\t\t}\n\t\tthis._index--;\n\t}\n};\n\nTokenizer.prototype._cleanup = function () {\n\tif(this._sectionStart < 0){\n\t\tthis._buffer = \"\";\n\t\tthis._index = 0;\n\t} else {\n\t\tif(this._state === TEXT){\n\t\t\tif(this._sectionStart !== this._index){\n\t\t\t\tthis._cbs.ontext(this._buffer.substr(this._sectionStart));\n\t\t\t}\n\t\t\tthis._buffer = \"\";\n\t\t\tthis._index = 0;\n\t\t} else if(this._sectionStart === this._index){\n\t\t\t//the section just started\n\t\t\tthis._buffer = \"\";\n\t\t\tthis._index = 0;\n\t\t} else {\n\t\t\t//remove everything unnecessary\n\t\t\tthis._buffer = this._buffer.substr(this._sectionStart);\n\t\t\tthis._index -= this._sectionStart;\n\t\t}\n\n\t\tthis._sectionStart = 0;\n\t}\n};\n\n//TODO make events conditional\nTokenizer.prototype.write = function(chunk){\n\tthis._buffer += chunk;\n\n\twhile(this._index < this._buffer.length && this._running){\n\t\tvar c = this._buffer.charAt(this._index);\n\t\tif(this._state === TEXT) {\n\t\t\tthis._stateText(c);\n\t\t} else if(this._state === BEFORE_TAG_NAME){\n\t\t\tthis._stateBeforeTagName(c);\n\t\t} else if(this._state === IN_TAG_NAME) {\n\t\t\tthis._stateInTagName(c);\n\t\t} else if(this._state === BEFORE_CLOSING_TAG_NAME){\n\t\t\tthis._stateBeforeCloseingTagName(c);\n\t\t} else if(this._state === IN_CLOSING_TAG_NAME){\n\t\t\tthis._stateInCloseingTagName(c);\n\t\t} else if(this._state === AFTER_CLOSING_TAG_NAME){\n\t\t\tthis._stateAfterCloseingTagName(c);\n\t\t} else if(this._state === IN_SELF_CLOSING_TAG){\n\t\t\tthis._stateInSelfClosingTag(c);\n\t\t}\n\n\t\t/*\n\t\t*\tattributes\n\t\t*/\n\t\telse if(this._state === BEFORE_ATTRIBUTE_NAME){\n\t\t\tthis._stateBeforeAttributeName(c);\n\t\t} else if(this._state === IN_ATTRIBUTE_NAME){\n\t\t\tthis._stateInAttributeName(c);\n\t\t} else if(this._state === AFTER_ATTRIBUTE_NAME){\n\t\t\tthis._stateAfterAttributeName(c);\n\t\t} else if(this._state === BEFORE_ATTRIBUTE_VALUE){\n\t\t\tthis._stateBeforeAttributeValue(c);\n\t\t} else if(this._state === IN_ATTRIBUTE_VALUE_DQ){\n\t\t\tthis._stateInAttributeValueDoubleQuotes(c);\n\t\t} else if(this._state === IN_ATTRIBUTE_VALUE_SQ){\n\t\t\tthis._stateInAttributeValueSingleQuotes(c);\n\t\t} else if(this._state === IN_ATTRIBUTE_VALUE_NQ){\n\t\t\tthis._stateInAttributeValueNoQuotes(c);\n\t\t}\n\n\t\t/*\n\t\t*\tdeclarations\n\t\t*/\n\t\telse if(this._state === BEFORE_DECLARATION){\n\t\t\tthis._stateBeforeDeclaration(c);\n\t\t} else if(this._state === IN_DECLARATION){\n\t\t\tthis._stateInDeclaration(c);\n\t\t}\n\n\t\t/*\n\t\t*\tprocessing instructions\n\t\t*/\n\t\telse if(this._state === IN_PROCESSING_INSTRUCTION){\n\t\t\tthis._stateInProcessingInstruction(c);\n\t\t}\n\n\t\t/*\n\t\t*\tcomments\n\t\t*/\n\t\telse if(this._state === BEFORE_COMMENT){\n\t\t\tthis._stateBeforeComment(c);\n\t\t} else if(this._state === IN_COMMENT){\n\t\t\tthis._stateInComment(c);\n\t\t} else if(this._state === AFTER_COMMENT_1){\n\t\t\tthis._stateAfterComment1(c);\n\t\t} else if(this._state === AFTER_COMMENT_2){\n\t\t\tthis._stateAfterComment2(c);\n\t\t}\n\n\t\t/*\n\t\t*\tcdata\n\t\t*/\n\t\telse if(this._state === BEFORE_CDATA_1){\n\t\t\tthis._stateBeforeCdata1(c);\n\t\t} else if(this._state === BEFORE_CDATA_2){\n\t\t\tthis._stateBeforeCdata2(c);\n\t\t} else if(this._state === BEFORE_CDATA_3){\n\t\t\tthis._stateBeforeCdata3(c);\n\t\t} else if(this._state === BEFORE_CDATA_4){\n\t\t\tthis._stateBeforeCdata4(c);\n\t\t} else if(this._state === BEFORE_CDATA_5){\n\t\t\tthis._stateBeforeCdata5(c);\n\t\t} else if(this._state === BEFORE_CDATA_6){\n\t\t\tthis._stateBeforeCdata6(c);\n\t\t} else if(this._state === IN_CDATA){\n\t\t\tthis._stateInCdata(c);\n\t\t} else if(this._state === AFTER_CDATA_1){\n\t\t\tthis._stateAfterCdata1(c);\n\t\t} else if(this._state === AFTER_CDATA_2){\n\t\t\tthis._stateAfterCdata2(c);\n\t\t}\n\n\t\t/*\n\t\t* special tags\n\t\t*/\n\t\telse if(this._state === BEFORE_SPECIAL){\n\t\t\tthis._stateBeforeSpecial(c);\n\t\t} else if(this._state === BEFORE_SPECIAL_END){\n\t\t\tthis._stateBeforeSpecialEnd(c);\n\t\t}\n\n\t\t/*\n\t\t* script\n\t\t*/\n\t\telse if(this._state === BEFORE_SCRIPT_1){\n\t\t\tthis._stateBeforeScript1(c);\n\t\t} else if(this._state === BEFORE_SCRIPT_2){\n\t\t\tthis._stateBeforeScript2(c);\n\t\t} else if(this._state === BEFORE_SCRIPT_3){\n\t\t\tthis._stateBeforeScript3(c);\n\t\t} else if(this._state === BEFORE_SCRIPT_4){\n\t\t\tthis._stateBeforeScript4(c);\n\t\t} else if(this._state === BEFORE_SCRIPT_5){\n\t\t\tthis._stateBeforeScript5(c);\n\t\t}\n\n\t\telse if(this._state === AFTER_SCRIPT_1){\n\t\t\tthis._stateAfterScript1(c);\n\t\t} else if(this._state === AFTER_SCRIPT_2){\n\t\t\tthis._stateAfterScript2(c);\n\t\t} else if(this._state === AFTER_SCRIPT_3){\n\t\t\tthis._stateAfterScript3(c);\n\t\t} else if(this._state === AFTER_SCRIPT_4){\n\t\t\tthis._stateAfterScript4(c);\n\t\t} else if(this._state === AFTER_SCRIPT_5){\n\t\t\tthis._stateAfterScript5(c);\n\t\t}\n\n\t\t/*\n\t\t* style\n\t\t*/\n\t\telse if(this._state === BEFORE_STYLE_1){\n\t\t\tthis._stateBeforeStyle1(c);\n\t\t} else if(this._state === BEFORE_STYLE_2){\n\t\t\tthis._stateBeforeStyle2(c);\n\t\t} else if(this._state === BEFORE_STYLE_3){\n\t\t\tthis._stateBeforeStyle3(c);\n\t\t} else if(this._state === BEFORE_STYLE_4){\n\t\t\tthis._stateBeforeStyle4(c);\n\t\t}\n\n\t\telse if(this._state === AFTER_STYLE_1){\n\t\t\tthis._stateAfterStyle1(c);\n\t\t} else if(this._state === AFTER_STYLE_2){\n\t\t\tthis._stateAfterStyle2(c);\n\t\t} else if(this._state === AFTER_STYLE_3){\n\t\t\tthis._stateAfterStyle3(c);\n\t\t} else if(this._state === AFTER_STYLE_4){\n\t\t\tthis._stateAfterStyle4(c);\n\t\t}\n\n\t\t/*\n\t\t* entities\n\t\t*/\n\t\telse if(this._state === BEFORE_ENTITY){\n\t\t\tthis._stateBeforeEntity(c);\n\t\t} else if(this._state === BEFORE_NUMERIC_ENTITY){\n\t\t\tthis._stateBeforeNumericEntity(c);\n\t\t} else if(this._state === IN_NAMED_ENTITY){\n\t\t\tthis._stateInNamedEntity(c);\n\t\t} else if(this._state === IN_NUMERIC_ENTITY){\n\t\t\tthis._stateInNumericEntity(c);\n\t\t} else if(this._state === IN_HEX_ENTITY){\n\t\t\tthis._stateInHexEntity(c);\n\t\t}\n\n\t\telse {\n\t\t\tthis._cbs.onerror(Error(\"unknown _state\"), this._state);\n\t\t}\n\n\t\tthis._index++;\n\t}\n\n\tthis._cleanup();\n};\n\nTokenizer.prototype.pause = function(){\n\tthis._running = false;\n};\nTokenizer.prototype.resume = function(){\n\tthis._running = true;\n};\n\nTokenizer.prototype.end = function(chunk){\n\tif(chunk) this.write(chunk);\n\n\t//if there is remaining data, emit it in a reasonable way\n\tif(this._sectionStart < this._index){\n\t\tthis._handleTrailingData();\n\t}\n\n\tthis._cbs.onend();\n};\n\nTokenizer.prototype._handleTrailingData = function(){\n\tvar data = this._buffer.substr(this._sectionStart);\n\n\tif(this._state === IN_CDATA || this._state === AFTER_CDATA_1 || this._state === AFTER_CDATA_2){\n\t\tthis._cbs.oncdata(data);\n\t} else if(this._state === IN_COMMENT || this._state === AFTER_COMMENT_1 || this._state === AFTER_COMMENT_2){\n\t\tthis._cbs.oncomment(data);\n\t} else if(this._state === IN_TAG_NAME){\n\t\tthis._cbs.onopentagname(data);\n\t} else if(this._state === BEFORE_ATTRIBUTE_NAME || this._state === BEFORE_ATTRIBUTE_VALUE || this._state === AFTER_ATTRIBUTE_NAME){\n\t\tthis._cbs.onopentagend();\n\t} else if(this._state === IN_ATTRIBUTE_NAME){\n\t\tthis._cbs.onattribname(data);\n\t} else if(this._state === IN_ATTRIBUTE_VALUE_SQ || this._state === IN_ATTRIBUTE_VALUE_DQ || this._state === IN_ATTRIBUTE_VALUE_NQ){\n\t\tthis._cbs.onattribdata(data);\n\t\tthis._cbs.onattribend();\n\t} else if(this._state === IN_CLOSING_TAG_NAME){\n\t\tthis._cbs.onclosetag(data);\n\t} else if(this._state === IN_NAMED_ENTITY && !this._xmlMode){\n\t\tthis._parseLegacyEntity();\n\t\tif(--this._sectionStart < this._index){\n\t\t\tthis._state = this._baseState;\n\t\t\tthis._handleTrailingData();\n\t\t}\n\t} else if(this._state === IN_NUMERIC_ENTITY && !this._xmlMode){\n\t\tthis._decodeNumericEntity(2, 10);\n\t\tif(this._sectionStart < this._index){\n\t\t\tthis._state = this._baseState;\n\t\t\tthis._handleTrailingData();\n\t\t}\n\t} else if(this._state === IN_HEX_ENTITY && !this._xmlMode){\n\t\tthis._decodeNumericEntity(3, 16);\n\t\tif(this._sectionStart < this._index){\n\t\t\tthis._state = this._baseState;\n\t\t\tthis._handleTrailingData();\n\t\t}\n\t} else {\n\t\tthis._cbs.ontext(data);\n\t}\n};\n\nTokenizer.prototype.reset = function(){\n\tTokenizer.call(this, {xmlMode: this._xmlMode, decodeEntities: this._decodeEntities}, this._cbs);\n};\n\nTokenizer.prototype._getSection = function(){\n\treturn this._buffer.substring(this._sectionStart, this._index);\n};\n\nTokenizer.prototype._emitToken = function(name){\n\tthis._cbs[name](this._getSection());\n\tthis._sectionStart = -1;\n};\n\nTokenizer.prototype._emitPartial = function(value){\n\tif(this._baseState !== TEXT){\n\t\tthis._cbs.onattribdata(value); //TODO implement the new event\n\t} else {\n\t\tthis._cbs.ontext(value);\n\t}\n};\n"]}