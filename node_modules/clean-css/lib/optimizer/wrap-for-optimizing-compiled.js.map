{"version":3,"sources":["wrap-for-optimizing.js"],"names":[],"mappings":"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","file":"wrap-for-optimizing-compiled.js","sourcesContent":["var Hack = require('./hack');\n\nvar Marker = require('../tokenizer/marker');\nvar Token = require('../tokenizer/token');\n\nvar Match = {\n  ASTERISK: '*',\n  BACKSLASH: '\\\\',\n  BANG: '!',\n  BANG_SUFFIX_PATTERN: /!\\w+$/,\n  IMPORTANT_TOKEN: '!important',\n  IMPORTANT_TOKEN_PATTERN: new RegExp('!important$', 'i'),\n  IMPORTANT_WORD: 'important',\n  IMPORTANT_WORD_PATTERN: new RegExp('important$', 'i'),\n  SUFFIX_BANG_PATTERN: /!$/,\n  UNDERSCORE: '_',\n  VARIABLE_REFERENCE_PATTERN: /var\\(--.+\\)$/\n};\n\nfunction wrapAll(properties, includeVariable, skipProperties) {\n  var wrapped = [];\n  var single;\n  var property;\n  var i;\n\n  for (i = properties.length - 1; i >= 0; i--) {\n    property = properties[i];\n\n    if (property[0] != Token.PROPERTY) {\n      continue;\n    }\n\n    if (!includeVariable && someVariableReferences(property)) {\n      continue;\n    }\n\n    if (skipProperties && skipProperties.indexOf(property[1][1]) > -1) {\n      continue;\n    }\n\n    single = wrapSingle(property);\n    single.all = properties;\n    single.position = i;\n    wrapped.unshift(single);\n  }\n\n  return wrapped;\n}\n\nfunction someVariableReferences(property) {\n  var i, l;\n  var value;\n\n  // skipping `property` and property name tokens\n  for (i = 2, l = property.length; i < l; i++) {\n    value = property[i];\n\n    if (value[0] != Token.PROPERTY_VALUE) {\n      continue;\n    }\n\n    if (isVariableReference(value[1])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction isVariableReference(value) {\n  return Match.VARIABLE_REFERENCE_PATTERN.test(value);\n}\n\nfunction isMultiplex(property) {\n  var value;\n  var i, l;\n\n  for (i = 3, l = property.length; i < l; i++) {\n    value = property[i];\n\n    if (value[0] == Token.PROPERTY_VALUE && (value[1] == Marker.COMMA || value[1] == Marker.FORWARD_SLASH)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction hackFrom(property) {\n  var match = false;\n  var name = property[1][1];\n  var lastValue = property[property.length - 1];\n\n  if (name[0] == Match.UNDERSCORE) {\n    match = [Hack.UNDERSCORE];\n  } else if (name[0] == Match.ASTERISK) {\n    match = [Hack.ASTERISK];\n  } else if (lastValue[1][0] == Match.BANG && !lastValue[1].match(Match.IMPORTANT_WORD_PATTERN)) {\n    match = [Hack.BANG];\n  } else if (lastValue[1].indexOf(Match.BANG) > 0 && !lastValue[1].match(Match.IMPORTANT_WORD_PATTERN) && Match.BANG_SUFFIX_PATTERN.test(lastValue[1])) {\n    match = [Hack.BANG];\n  } else if (lastValue[1].indexOf(Match.BACKSLASH) > 0 && lastValue[1].indexOf(Match.BACKSLASH) == lastValue[1].length - Match.BACKSLASH.length - 1) {\n    match = [Hack.BACKSLASH, lastValue[1].substring(lastValue[1].indexOf(Match.BACKSLASH) + 1)];\n  } else if (lastValue[1].indexOf(Match.BACKSLASH) === 0 && lastValue[1].length == 2) {\n    match = [Hack.BACKSLASH, lastValue[1].substring(1)];\n  }\n\n  return match;\n}\n\nfunction isImportant(property) {\n  if (property.length < 3)\n    return false;\n\n  var lastValue = property[property.length - 1];\n  if (Match.IMPORTANT_TOKEN_PATTERN.test(lastValue[1])) {\n    return true;\n  } else if (Match.IMPORTANT_WORD_PATTERN.test(lastValue[1]) && Match.SUFFIX_BANG_PATTERN.test(property[property.length - 2][1])) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction stripImportant(property) {\n  var lastValue = property[property.length - 1];\n  var oneButLastValue = property[property.length - 2];\n\n  if (Match.IMPORTANT_TOKEN_PATTERN.test(lastValue[1])) {\n    lastValue[1] = lastValue[1].replace(Match.IMPORTANT_TOKEN_PATTERN, '');\n  } else {\n    lastValue[1] = lastValue[1].replace(Match.IMPORTANT_WORD_PATTERN, '');\n    oneButLastValue[1] = oneButLastValue[1].replace(Match.SUFFIX_BANG_PATTERN, '');\n  }\n\n  if (lastValue[1].length === 0) {\n    property.pop();\n  }\n\n  if (oneButLastValue[1].length === 0) {\n    property.pop();\n  }\n}\n\nfunction stripPrefixHack(property) {\n  property[1][1] = property[1][1].substring(1);\n}\n\nfunction stripSuffixHack(property, hackFrom) {\n  var lastValue = property[property.length - 1];\n  lastValue[1] = lastValue[1]\n    .substring(0, lastValue[1].indexOf(hackFrom[0] == Hack.BACKSLASH ? Match.BACKSLASH : Match.BANG))\n    .trim();\n\n  if (lastValue[1].length === 0) {\n    property.pop();\n  }\n}\n\nfunction wrapSingle(property) {\n  var importantProperty = isImportant(property);\n  if (importantProperty) {\n    stripImportant(property);\n  }\n\n  var whichHack = hackFrom(property);\n  if (whichHack[0] == Hack.ASTERISK || whichHack[0] == Hack.UNDERSCORE) {\n    stripPrefixHack(property);\n  } else if (whichHack[0] == Hack.BACKSLASH || whichHack[0] == Hack.BANG) {\n    stripSuffixHack(property, whichHack);\n  }\n\n  return {\n    block: property[2] && property[2][0] == Token.PROPERTY_BLOCK,\n    components: [],\n    dirty: false,\n    hack: whichHack,\n    important: importantProperty,\n    name: property[1][1],\n    multiplex: property.length > 3 ? isMultiplex(property) : false,\n    position: 0,\n    shorthand: false,\n    unused: false,\n    value: property.slice(2)\n  };\n}\n\nmodule.exports = {\n  all: wrapAll,\n  single: wrapSingle\n};\n"]}