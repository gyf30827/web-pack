{"version":3,"sources":["rewrite-url.js"],"names":[],"mappings":"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","file":"rewrite-url-compiled.js","sourcesContent":["var path = require('path');\nvar url = require('url');\n\nvar DOUBLE_QUOTE = '\"';\nvar SINGLE_QUOTE = '\\'';\nvar URL_PREFIX = 'url(';\nvar URL_SUFFIX = ')';\n\nvar QUOTE_PREFIX_PATTERN = /^[\"']/;\nvar QUOTE_SUFFIX_PATTERN = /[\"']$/;\nvar ROUND_BRACKETS_PATTERN = /[\\(\\)]/;\nvar URL_PREFIX_PATTERN = /^url\\(/i;\nvar URL_SUFFIX_PATTERN = /\\)$/;\nvar WHITESPACE_PATTERN = /\\s/;\n\nvar isWindows = process.platform == 'win32';\n\nfunction rebase(uri, rebaseConfig) {\n  if (!rebaseConfig) {\n    return uri;\n  }\n\n  if (isAbsolute(uri) && !isRemote(rebaseConfig.toBase)) {\n    return uri;\n  }\n\n  if (isRemote(uri) || isSVGMarker(uri) || isInternal(uri)) {\n    return uri;\n  }\n\n  if (isData(uri)) {\n    return '\\'' + uri + '\\'';\n  }\n\n  if (isRemote(rebaseConfig.toBase)) {\n    return url.resolve(rebaseConfig.toBase, uri);\n  }\n\n  return rebaseConfig.absolute ?\n    normalize(absolute(uri, rebaseConfig)) :\n    normalize(relative(uri, rebaseConfig));\n}\n\nfunction isAbsolute(uri) {\n  return path.isAbsolute(uri);\n}\n\nfunction isSVGMarker(uri) {\n  return uri[0] == '#';\n}\n\nfunction isInternal(uri) {\n  return /^\\w+:\\w+/.test(uri);\n}\n\nfunction isRemote(uri) {\n  return /^[^:]+?:\\/\\//.test(uri) || uri.indexOf('//') === 0;\n}\n\nfunction isData(uri) {\n  return uri.indexOf('data:') === 0;\n}\n\nfunction absolute(uri, rebaseConfig) {\n  return path\n    .resolve(path.join(rebaseConfig.fromBase || '', uri))\n    .replace(rebaseConfig.toBase, '');\n}\n\nfunction relative(uri, rebaseConfig) {\n  return path.relative(rebaseConfig.toBase, path.join(rebaseConfig.fromBase || '', uri));\n}\n\nfunction normalize(uri) {\n  return isWindows ? uri.replace(/\\\\/g, '/') : uri;\n}\n\nfunction quoteFor(unquotedUrl) {\n  if (unquotedUrl.indexOf(SINGLE_QUOTE) > -1) {\n    return DOUBLE_QUOTE;\n  } else if (unquotedUrl.indexOf(DOUBLE_QUOTE) > -1) {\n    return SINGLE_QUOTE;\n  } else if (hasWhitespace(unquotedUrl) || hasRoundBrackets(unquotedUrl)) {\n    return SINGLE_QUOTE;\n  } else {\n    return '';\n  }\n}\n\nfunction hasWhitespace(url) {\n  return WHITESPACE_PATTERN.test(url);\n}\n\nfunction hasRoundBrackets(url) {\n  return ROUND_BRACKETS_PATTERN.test(url);\n}\n\nfunction rewriteUrl(originalUrl, rebaseConfig, pathOnly) {\n  var strippedUrl = originalUrl\n    .replace(URL_PREFIX_PATTERN, '')\n    .replace(URL_SUFFIX_PATTERN, '')\n    .trim();\n\n  var unquotedUrl = strippedUrl\n    .replace(QUOTE_PREFIX_PATTERN, '')\n    .replace(QUOTE_SUFFIX_PATTERN, '')\n    .trim();\n\n  var quote = strippedUrl[0] == SINGLE_QUOTE || strippedUrl[0] == DOUBLE_QUOTE ?\n    strippedUrl[0] :\n    quoteFor(unquotedUrl);\n\n  return pathOnly ?\n    rebase(unquotedUrl, rebaseConfig) :\n    URL_PREFIX + quote + rebase(unquotedUrl, rebaseConfig) + quote + URL_SUFFIX;\n}\n\nmodule.exports = rewriteUrl;\n"]}