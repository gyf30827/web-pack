{"version":3,"sources":["RenderKid.js"],"names":[],"mappings":"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","file":"RenderKid-compiled.js","sourcesContent":["// Generated by CoffeeScript 1.9.3\nvar AnsiPainter, Layout, RenderKid, Styles, blockStyleApplier, inlineStyleApplier, object, stripAnsi, terminalWidth, tools;\n\ninlineStyleApplier = require('./renderKid/styleApplier/inline');\n\nblockStyleApplier = require('./renderKid/styleApplier/block');\n\nAnsiPainter = require('./AnsiPainter');\n\nStyles = require('./renderKid/Styles');\n\nLayout = require('./Layout');\n\ntools = require('./tools');\n\nobject = require('utila').object;\n\nstripAnsi = require('strip-ansi');\n\nterminalWidth = require('./tools').getCols();\n\nmodule.exports = RenderKid = (function() {\n  var self;\n\n  self = RenderKid;\n\n  RenderKid.AnsiPainter = AnsiPainter;\n\n  RenderKid.Layout = Layout;\n\n  RenderKid.quote = tools.quote;\n\n  RenderKid.tools = tools;\n\n  RenderKid._defaultConfig = {\n    layout: {\n      terminalWidth: terminalWidth\n    }\n  };\n\n  function RenderKid(config) {\n    if (config == null) {\n      config = {};\n    }\n    this.tools = self.tools;\n    this._config = object.append(self._defaultConfig, config);\n    this._initStyles();\n  }\n\n  RenderKid.prototype._initStyles = function() {\n    return this._styles = new Styles;\n  };\n\n  RenderKid.prototype.style = function() {\n    return this._styles.setRule.apply(this._styles, arguments);\n  };\n\n  RenderKid.prototype._getStyleFor = function(el) {\n    return this._styles.getStyleFor(el);\n  };\n\n  RenderKid.prototype.render = function(input, withColors) {\n    if (withColors == null) {\n      withColors = true;\n    }\n    return this._paint(this._renderDom(this._toDom(input)), withColors);\n  };\n\n  RenderKid.prototype._toDom = function(input) {\n    if (typeof input === 'string') {\n      return this._parse(input);\n    } else if (object.isBareObject(input) || Array.isArray(input)) {\n      return this._objToDom(input);\n    } else {\n      throw Error(\"Invalid input type. Only strings, arrays and objects are accepted\");\n    }\n  };\n\n  RenderKid.prototype._objToDom = function(o, injectFakeRoot) {\n    if (injectFakeRoot == null) {\n      injectFakeRoot = true;\n    }\n    if (injectFakeRoot) {\n      o = {\n        body: o\n      };\n    }\n    return tools.objectToDom(o);\n  };\n\n  RenderKid.prototype._paint = function(text, withColors) {\n    var painted;\n    painted = AnsiPainter.paint(text);\n    if (withColors) {\n      return painted;\n    } else {\n      return stripAnsi(painted);\n    }\n  };\n\n  RenderKid.prototype._parse = function(string, injectFakeRoot) {\n    if (injectFakeRoot == null) {\n      injectFakeRoot = true;\n    }\n    if (injectFakeRoot) {\n      string = '<body>' + string + '</body>';\n    }\n    return tools.stringToDom(string);\n  };\n\n  RenderKid.prototype._renderDom = function(dom) {\n    var bodyTag, layout, rootBlock;\n    bodyTag = dom[0];\n    layout = new Layout(this._config.layout);\n    rootBlock = layout.getRootBlock();\n    this._renderBlockNode(bodyTag, null, rootBlock);\n    return layout.get();\n  };\n\n  RenderKid.prototype._renderChildrenOf = function(parentNode, parentBlock) {\n    var i, len, node, nodes;\n    nodes = parentNode.children;\n    for (i = 0, len = nodes.length; i < len; i++) {\n      node = nodes[i];\n      this._renderNode(node, parentNode, parentBlock);\n    }\n  };\n\n  RenderKid.prototype._renderNode = function(node, parentNode, parentBlock) {\n    if (node.type === 'text') {\n      this._renderText(node, parentNode, parentBlock);\n    } else if (node.name === 'br') {\n      this._renderBr(node, parentNode, parentBlock);\n    } else if (this._isBlock(node)) {\n      this._renderBlockNode(node, parentNode, parentBlock);\n    } else if (this._isNone(node)) {\n      return;\n    } else {\n      this._renderInlineNode(node, parentNode, parentBlock);\n    }\n  };\n\n  RenderKid.prototype._renderText = function(node, parentNode, parentBlock) {\n    var ref, text;\n    text = node.data;\n    text = text.replace(/\\s+/g, ' ');\n    if ((parentNode != null ? (ref = parentNode.styles) != null ? ref.display : void 0 : void 0) !== 'inline') {\n      text = text.trim();\n    }\n    if (text.length === 0) {\n      return;\n    }\n    text = text.replace(/&nl;/g, \"\\n\");\n    return parentBlock.write(text);\n  };\n\n  RenderKid.prototype._renderBlockNode = function(node, parentNode, parentBlock) {\n    var after, before, block, blockConfig, ref;\n    ref = blockStyleApplier.applyTo(node, this._getStyleFor(node)), before = ref.before, after = ref.after, blockConfig = ref.blockConfig;\n    block = parentBlock.openBlock(blockConfig);\n    if (before !== '') {\n      block.write(before);\n    }\n    this._renderChildrenOf(node, block);\n    if (after !== '') {\n      block.write(after);\n    }\n    return block.close();\n  };\n\n  RenderKid.prototype._renderInlineNode = function(node, parentNode, parentBlock) {\n    var after, before, ref;\n    ref = inlineStyleApplier.applyTo(node, this._getStyleFor(node)), before = ref.before, after = ref.after;\n    if (before !== '') {\n      parentBlock.write(before);\n    }\n    this._renderChildrenOf(node, parentBlock);\n    if (after !== '') {\n      return parentBlock.write(after);\n    }\n  };\n\n  RenderKid.prototype._renderBr = function(node, parentNode, parentBlock) {\n    return parentBlock.write(\"\\n\");\n  };\n\n  RenderKid.prototype._isBlock = function(node) {\n    return !(node.type === 'text' || node.name === 'br' || this._getStyleFor(node).display !== 'block');\n  };\n\n  RenderKid.prototype._isNone = function(node) {\n    return !(node.type === 'text' || node.name === 'br' || this._getStyleFor(node).display !== 'none');\n  };\n\n  return RenderKid;\n\n})();\n"]}