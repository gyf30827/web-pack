{"version":3,"sources":["$.task.js"],"names":[],"mappings":"AAAA,IAAI,MAAqB,QAAQ,SAAR,CAAzB;AAAA,IACI,SAAqB,QAAQ,YAAR,CADzB;AAAA,IAEI,OAAqB,QAAQ,UAAR,CAFzB;AAAA,IAGI,MAAqB,QAAQ,gBAAR,CAHzB;AAAA,IAII,SAAqB,QAAQ,YAAR,CAJzB;AAAA,IAKI,UAAqB,OAAO,OALhC;AAAA,IAMI,UAAqB,OAAO,YANhC;AAAA,IAOI,YAAqB,OAAO,cAPhC;AAAA,IAQI,iBAAqB,OAAO,cARhC;AAAA,IASI,UAAqB,CATzB;AAAA,IAUI,QAAqB,EAVzB;AAAA,IAWI,qBAAqB,oBAXzB;AAAA,IAYI,KAZJ;AAAA,IAYW,OAZX;AAAA,IAYoB,IAZpB;AAaA,IAAI,MAAM,YAAU;AAClB,MAAI,KAAK,CAAC,IAAV;AACA,MAAG,MAAM,cAAN,CAAqB,EAArB,CAAH,EAA4B;AAC1B,QAAI,KAAK,MAAM,EAAN,CAAT;AACA,WAAO,MAAM,EAAN,CAAP;AACA;AACD;AACF,CAPD;AAQA,IAAI,UAAU,UAAS,KAAT,EAAe;AAC3B,MAAI,IAAJ,CAAS,MAAM,IAAf;AACD,CAFD;AAGA;AACA,IAAG,CAAC,OAAD,IAAY,CAAC,SAAhB,EAA0B;AACxB,YAAU,SAAS,YAAT,CAAsB,EAAtB,EAAyB;AACjC,QAAI,OAAO,EAAX;AAAA,QAAe,IAAI,CAAnB;AACA,WAAM,UAAU,MAAV,GAAmB,CAAzB,EAA2B,KAAK,IAAL,CAAU,UAAU,GAAV,CAAV;AAC3B,UAAM,EAAE,OAAR,IAAmB,YAAU;AAC3B,aAAO,OAAO,EAAP,IAAa,UAAb,GAA0B,EAA1B,GAA+B,SAAS,EAAT,CAAtC,EAAoD,IAApD;AACD,KAFD;AAGA,UAAM,OAAN;AACA,WAAO,OAAP;AACD,GARD;AASA,cAAY,SAAS,cAAT,CAAwB,EAAxB,EAA2B;AACrC,WAAO,MAAM,EAAN,CAAP;AACD,GAFD;AAGA;AACA,MAAG,QAAQ,SAAR,EAAmB,OAAnB,KAA+B,SAAlC,EAA4C;AAC1C,YAAQ,UAAS,EAAT,EAAY;AAClB,cAAQ,QAAR,CAAiB,IAAI,GAAJ,EAAS,EAAT,EAAa,CAAb,CAAjB;AACD,KAFD;AAGF;AACC,GALD,MAKO,IAAG,cAAH,EAAkB;AACvB,cAAU,IAAI,cAAJ,EAAV;AACA,WAAU,QAAQ,KAAlB;AACA,YAAQ,KAAR,CAAc,SAAd,GAA0B,OAA1B;AACA,YAAQ,IAAI,KAAK,WAAT,EAAsB,IAAtB,EAA4B,CAA5B,CAAR;AACF;AACA;AACC,GAPM,MAOA,IAAG,OAAO,gBAAP,IAA2B,OAAO,WAAP,IAAsB,UAAjD,IAA+D,CAAC,OAAO,aAA1E,EAAwF;AAC7F,YAAQ,UAAS,EAAT,EAAY;AAClB,aAAO,WAAP,CAAmB,KAAK,EAAxB,EAA4B,GAA5B;AACD,KAFD;AAGA,WAAO,gBAAP,CAAwB,SAAxB,EAAmC,OAAnC,EAA4C,KAA5C;AACF;AACC,GANM,MAMA,IAAG,sBAAsB,IAAI,QAAJ,CAAzB,EAAuC;AAC5C,YAAQ,UAAS,EAAT,EAAY;AAClB,WAAK,WAAL,CAAiB,IAAI,QAAJ,CAAjB,EAAgC,kBAAhC,IAAsD,YAAU;AAC9D,aAAK,WAAL,CAAiB,IAAjB;AACA,YAAI,IAAJ,CAAS,EAAT;AACD,OAHD;AAID,KALD;AAMF;AACC,GARM,MAQA;AACL,YAAQ,UAAS,EAAT,EAAY;AAClB,iBAAW,IAAI,GAAJ,EAAS,EAAT,EAAa,CAAb,CAAX,EAA4B,CAA5B;AACD,KAFD;AAGD;AACF;AACD,OAAO,OAAP,GAAiB;AACf,OAAO,OADQ;AAEf,SAAO;AAFQ,CAAjB","file":"$.task-compiled.js","sourcesContent":["var ctx                = require('./$.ctx')\n  , invoke             = require('./$.invoke')\n  , html               = require('./$.html')\n  , cel                = require('./$.dom-create')\n  , global             = require('./$.global')\n  , process            = global.process\n  , setTask            = global.setImmediate\n  , clearTask          = global.clearImmediate\n  , MessageChannel     = global.MessageChannel\n  , counter            = 0\n  , queue              = {}\n  , ONREADYSTATECHANGE = 'onreadystatechange'\n  , defer, channel, port;\nvar run = function(){\n  var id = +this;\n  if(queue.hasOwnProperty(id)){\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listner = function(event){\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif(!setTask || !clearTask){\n  setTask = function setImmediate(fn){\n    var args = [], i = 1;\n    while(arguments.length > i)args.push(arguments[i++]);\n    queue[++counter] = function(){\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id){\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if(require('./$.cof')(process) == 'process'){\n    defer = function(id){\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if(MessageChannel){\n    channel = new MessageChannel;\n    port    = channel.port2;\n    channel.port1.onmessage = listner;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if(global.addEventListener && typeof postMessage == 'function' && !global.importScripts){\n    defer = function(id){\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listner, false);\n  // IE8-\n  } else if(ONREADYSTATECHANGE in cel('script')){\n    defer = function(id){\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function(){\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function(id){\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set:   setTask,\n  clear: clearTask\n};"]}